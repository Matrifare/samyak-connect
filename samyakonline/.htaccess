# Samyak Matrimony - Modern MVC Routing
# All requests are routed through public/index.php

IndexIgnore * # prevent directory listing

<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    # Handle static assets directly
    RewriteRule ^(.*)\.[\d]{10}\.(css|js)$ $1.$2 [L]
    
    # If file/directory exists in public folder, serve it
    RewriteCond %{REQUEST_URI} ^/templates/assets/ [OR]
    RewriteCond %{REQUEST_URI} ^/assets/ [OR]
    RewriteCond %{REQUEST_URI} ^/css/ [OR]
    RewriteCond %{REQUEST_URI} ^/js/ [OR]
    RewriteCond %{REQUEST_URI} ^/images/ [OR]
    RewriteCond %{REQUEST_URI} ^/fonts/ [OR]
    RewriteCond %{REQUEST_URI} ^/icons/
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule ^ - [L]

    # Skip if requesting a real file or directory
    RewriteCond %{REQUEST_FILENAME} -f [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]

    # Route everything else through the MVC front controller
    RewriteRule ^(.*)$ public/index.php [QSA,L]
</IfModule>

# Security headers
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set X-XSS-Protection "1; mode=block"
</IfModule>

# Prevent access to sensitive files
<FilesMatch "\.(env|local\.php|git|gitignore|md|lock|json)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# PHP settings
<IfModule mod_php.c>
    php_value display_errors 0
    php_value log_errors 1
</IfModule>
